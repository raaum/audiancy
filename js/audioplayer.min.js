window.onload=function(){function e(){var e={};2>F?d.tracks=d.track:null,console.log(d.playlist+" ("+F+" "+d.tracks+")");for(var t=0;t<g.length;t++){g[t].currentTime=0;var o=t+1;G[t]=g[t].getAttribute("title"),W[t]=g[t].getAttribute("src"),K[t]=g[t].getAttribute("type"),$[t]=g[t].getAttribute("album"),O[t]=g[t].getAttribute("artist"),J[t]=g[t].getAttribute("poster"),console.log("\n"+"-".repeat(60)),console.log(d.track+" "+o),console.log("-".repeat(60)+"\n"),console.log(d.title+" "+G[t]),console.log(d.source+" "+W[t]),console.log(d.mimetype+" "+K[t]),console.log(d.artist+" "+O[t]),console.log(d.album+" "+$[t]),console.log(d.poster+" "+J[t]),e[t]={"title ":G[t],source:W[t],type:K[t],album:$[t],artist:O[t],poster:J[t]}}console.log("\n\n"),P=g[0],j="0",z="0",oe[0]=Z.createMediaElementSource(P),ne[0]=1,oe[0].connect(ee),oe[0].connect(Z.destination),k.classList.add("notavailable"),b.classList.add("notavailable"),g[1]&&b.classList.remove("notavailable"),l(),n();var a=JSON.stringify(e);console.log(a)}function t(e){m?console.log(d.error+": "+e):null}function o(e,t){p?console.log(d.event+" "+e+" "+d.time+" "+t):null}function n(){var e=document.getElementById("audio_title"),t=document.getElementById("audio_artist"),o=document.getElementById("audio_album"),n=(document.getElementById("audio_volume"),document.getElementById("audio_mute")),a=document.getElementById("audio_progress");document.getElementById("audio_time_elapsed"),document.getElementById("audio_time_left");u(),e.innerHTML=G[j],t.innerHTML=O[j],o.innerHTML=$[j],a.innerHTML="",n.innerHTML="",J[j]&&l(j)}function a(){function e(e,t){e="next"==e?b:k,1==t?(e.classList.remove("notavailable"),e.classList.add("available")):(e.classList.remove("available"),e.classList.add("notavailable"))}function t(e){oe[e]=Z.createMediaElementSource(P),oe[e].connect(ee),oe[e].connect(Z.destination),ne[e]=1}function i(){var e=c(P.duration);console.log(d.title+" "+P.title),console.log(d.source+" "+P.src),console.log(d.time+" "+P.currentTime),console.log(d.volume+" "+P.volume),console.log(d.duration+" "+e)}function m(){X[j]=1,console.log("Adding listeners for playing, ended, pause"),P.addEventListener("playing",function(e){U||s(),U=1,V[j]=!0,r(),H=window.setInterval(u,1e3),e.preventDefault(),console.log("Next up is "+G[y])}),P.addEventListener("ended",function(e){H&&clearInterval(H),console.log(d.playended),P.pause(),P.currentTime=0,n(y),j=y,a(),e.preventDefault()}),console.log("Adding pause listener for "+G[j]),P.addEventListener("pause",function(e){o(d.paused,P.currentTime),l(),M.style.opacity=0,q=0,e.preventDefault()})}console.log("track count is "+j);var p=j,y=j,v=j;q=0,y++,v--,g[y]?e("next","1"):e("next","0"),g[v]?e("prev","1"):e("prev","0"),P=g[j],n(),l(),P.load,4===P.readyState&&(ne[p]||t(p),Q[p]=1,console.log(d.ready),i(),X[p]||m(),P.play())}function i(){H&&clearInterval(H),o(d.stopclicked,P.currentTime),P.pause(),P.currentTime=0,l(),V[j]=0,Q[j]=0,o(d.reset,P.currentTime)}function l(){var e="url("+J[j]+")";T.style.backgroundImage=e,T.style.backgroundRepeat="no-repeat",I.style.opacity=0}function r(){I.style.opacity=1,M.style.opacity=1}function u(){var e=Math.floor(P.currentTime),t=Math.floor(e),o=c(t);if(S.innerHTML=o,P.duration){var n=Math.floor(P.duration),a=Math.floor(n-e),i=c(a);B.innerHTML="-"+i;var l=Math.floor(e/n*100);A.style.width=l+"%"}}function c(e){var t=Math.floor(e/3600),o=e%3600,n=Math.floor(o/60),a=o%60,i=Math.ceil(a);10>t?t="0"+t:!1,10>n?n="0"+n:!1,10>i?i="0"+i:!1;var l,r=t+":"+n+":"+i,u=n+":"+i;return l=t>0?r:u}function s(){function e(){_.clearRect(0,0,R,x),C.clearRect(0,0,R,x);var n,a=(requestAnimationFrame(e),1),i=0;ee.getByteFrequencyData(o);for(var l=48;t>l;l++){n=o[l];var r=105,u=112,c=220,s=188,d=255,m=255;r-=n,u-=n,c-=n,s+=n,_.fillStyle="rgb("+r+","+c+","+d+")",C.fillStyle="rgb("+u+","+s+","+m+")",_.fillRect(i,x-n,a,n),C.fillRect(i,x-n,a,n),i+=a+0}}ee.fftSize=2048;var t=ee.frequencyBinCount,o=new Uint8Array(t);_.clearRect(0,0,R,x),C.clearRect(0,0,R,x),e()}$jsonPlayList=[{0:{"title ":"Southern Nights",source:"audio/Southern Nights.mp3",type:"audio/mp3",album:"Southern Nights",artist:"Glen Campbell",poster:"audio/images/campbell.jpg"},1:{"title ":"A Fifth of Beethoven",source:"audio/A Fifth of Beethoven.mp3",type:"audio/mp3",album:"Saturday Night Fever Soundtrack",artist:"Walter Murphy",poster:"audio/images/snf.jpg"},2:{"title ":"Ain't No Sunshine",source:"audio/Aint No Sunshine.mp3",type:"audio/mp3",album:"Just as I Am",artist:"Bill Withers",poster:"audio/images/withers.jpg"},3:{"title ":"Tempted",source:"audio/Tempted.mp3",type:"audio/mp3",album:"East Side Story",artist:"Squeeze",poster:"audio/images/squeeze.jpg"},4:{"title ":"Raspberry Beret",source:"audio/Raspberry Beret.mp3",type:"audio/mp3",album:"Around the World in a Day",artist:"Prince, The Revolution",poster:"audio/images/prince.jpg"},5:{"title ":"ABC",source:"audio/abc.mp3",type:"audio/mp3",album:"ABC",artist:"The Jackson Five",poster:"audio/images/jackson5.jpg"}}];var d={album:"Album:",artist:"Artist:",audioel:"Audio Element",audionf:"Audio Element Not Found.",belmissing:"Button Element Not Found",button:"Button",click:"Click",clicked:"Clicked",duration:"Duration:",error:"Error!",event:"Event:",missing:"Missing",notfound:"Not Found",pause:"Pause",pauseclicked:"Pause Clicked.",paused:"Audio Paused.",play:"Play",playclicked:"Play Clicked.",playended:"Playback Ended.",playlist:"Playlist",playlistnf:"Playlist Not Found",poster:"Poster",seekcomplete:"Seek Complete.",seekstarted:"Seek Started.",stop:"Stop",stopclicked:"Stop Clicked.",time:"Time:",title:"Title:",track:"Track",tracks:"Tracks",mimetype:"MIME Type:",ready:"Ready",reset:"Reset Initiated.",source:"Source:",volume:"Volume:"},m=1,p=1,g=document.getElementsByTagName("audio"),y=document.getElementById("playlist_panel"),v=document.getElementById("panel_button"),f=document.getElementById("play"),b=document.getElementById("next"),k=document.getElementById("previous"),h=document.getElementById("pause"),E=document.getElementById("stop"),B=document.getElementById("audio_time_left"),A=document.getElementById("audio_progress"),S=document.getElementById("audio_time_elapsed"),I=document.querySelector(".posterwrap"),T=document.getElementById("audioplayer"),M=document.querySelector(".canvaswrapper"),L=document.querySelector(".visualizer"),w=document.querySelector(".visualizer2"),_=L.getContext("2d"),C=w.getContext("2d"),D=M.clientWidth,N=M.clientHeight/2,R=D,x=N;M.style.opacity=0,L.setAttribute("width",D),w.setAttribute("width",D);var F=g.length,P=null,q=0,j=0,H=0,z=0,U=0,G={},W={},J={},O={},V={},$={},K={},Q={},X={};navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;var Y=window.AudioContext||window.webkitAudioContext,Z=new Y,ee=Z.createAnalyser();ee.minDecibels=-90,ee.maxDecibels=100,ee.smoothingTimeConstant=.85;var te=(Z.createWaveShaper(),Z.createGain()),oe=(Z.createBiquadFilter(),Z.createConvolver(),{}),ne={};ee.connect(Z.destination),te.connect(Z.destination),e(),f.onclick=function(e){a(),e.preventDefault()},b.onclick=function(e){i(),j++,g[j]?!0:j="0",a(),e.preventDefault()},k.onclick=function(e){i(),j--,g[j]?!0:j="0",a(),e.preventDefault()},v.onclick=function(e){y.classList.toggle("expand"),e.preventDefault()},h?h.onclick=function(e){P.pause(),e.preventDefault(),o(d.pauseclicked,P.currentTime)}:t(d.pause+" "+d.belmissing),E?E.onclick=function(e){i(),e.preventDefault(),H&&clearInterval(H)}:t(d.stop+" "+d.belmissing)};